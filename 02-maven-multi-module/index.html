<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <title>메이븐 멀티모듈 SNS 개발 #2 - domain과 service</title>
  <meta name="description" content="Web 프로젝트먼저 사용자의 뷰를 담당하는 Web 프로젝트를 구성해 보겠습니다. Web프로젝트는 웹 브라우저를 통해 접근하는 사용자에 대한 entry point입니다. 즉 Front-end에 대한 구현체이며 기본적인 사항은 다음과 같습니다.  Spring MVC 5  Thymeleaf">
  
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://youngwonseo.github.io/02-maven-multi-module/">
  <link rel="alternate" type="application/atom+xml" title="서영원 블로그" href="https://youngwonseo.github.io/feed.xml" />  
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/moonspam/NanumBarunGothic@latest/nanumbarungothicsubset.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
</head>

  <body>
    

<div class="header-container" id="header-container">

<!-- Site navigation -->
  <nav class="site-nav">
    <div class="trigger">
      
        
        <a class="page-link" href="/about/">About</a>
        
      
        
        <a class="page-link" href="/archive/">Archive</a>
        
      
        
      
        
      
        
      
        
        <a class="page-link" href="/category/">Paper</a>
        
      
        
        <a class="page-link" href="/projects/">Projects</a>
        
      
        
        <a class="page-link" href="/study/">Study</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      <a class="page-link" href="/feed.xml">RSS</a>
    </div>
  </nav>

  <!-- The title of the site -->
  <header class="site-header">
    <!-- <a href="/">
      <div class="avatar">
        <img src="/assets/images/avatar.png" />
      </div>
    </a> -->
    <a class="site-title" href="/">서영원 블로그</a>
  </header>

</div>

      <div class="wrapper">
        <div class="page-content">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">메이븐 멀티모듈 SNS 개발 #2 - domain과 service</h1>
    <p class="post-meta">2020-02-29 / Youngwon Seo</p>
  </header>



  <article class="post-content">
    <h2 id="web-프로젝트">Web 프로젝트</h2>
<p>먼저 사용자의 뷰를 담당하는 Web 프로젝트를 구성해 보겠습니다. Web프로젝트는 웹 브라우저를 통해 접근하는 사용자에 대한 entry point입니다. 즉 Front-end에 대한 구현체이며 기본적인 사항은 다음과 같습니다.</p>
<ul>
  <li>Spring MVC 5</li>
  <li>Thymeleaf</li>
</ul>

<p>위 두가지를 사용하기 위해 pom.xml에 두가지에 대한 메이븐 의존성을 추가합니다.</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>cms<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>web<span class="nt">&lt;/artifactId&gt;</span>

	<span class="nt">&lt;dependencies&gt;</span>
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-webmvc<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;version&gt;</span>5.1.5.RELEASE<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.thymeleaf<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>thymeleaf-spring5<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;version&gt;</span>3.0.11.RELEASE<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<h3 id="dynamic-webproject-설정">Dynamic webproject 설정</h3>
<p>위에서 CMS의 하위 모듈로 생성한 web프로젝트를 tomcat으로 기동할 수 있도록 설정해 보겠습니다.</p>
<ol>
  <li>web프로젝트 우클릭 -&gt; properties 접근</li>
  <li>Project Facets 접근</li>
  <li>Convert to faceted from.. 클릭</li>
  <li>Dynamic Web Module 체크</li>
</ol>

<p>Dynamic webproject가 설정이 완료되면 프로젝트의 루트 경로에 WebContent폴더가 추가된 것을 확인할 수 있습니다. WebContent는 web.xml, servlet-context.xml등의 설정 파일과 함께 view에 대한 html파일, javascript 파일들을 담게 됩니다.</p>

<p>추가적으로 WebContent가 추가되면 properties의 Deployment Assembly에 Source가 /WebContent, Delpoy Path가 / 인 배포경로가 생성됩니다.</p>

<h3 id="maven-dependencies">Maven Dependencies</h3>
<p>properties의 Deployment Assembly에 Add를 클릭해 Java Build Path Entries -&gt; Maven Dependencies를 추가합니다. 추가를 하지 않으면 ClassNotFountException이 발생하게 됩니다.</p>

<h3 id="webxml">web.xml</h3>
<p>톰캣과 같은 WAS가 프로젝트를 웹어플리케이션으로 실행하기 위해서는 배포 및 서블릿 스팩 등이 기술된 web.xml 파일이 필수로 필요합니다. 톰캣이 실행할때 web.xml파일을 기반으로 dispatcher 및 기타 속성들에 접근을 시도합니다. web.xml은 WebContent/WEB-INF 의 경로에 생성합니다.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;web-app</span> 
	<span class="na">xmlns=</span><span class="s">"http://xmlns.jcp.org/xml/ns/javaee"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span>
	<span class="na">version=</span><span class="s">"3.1"</span><span class="nt">&gt;</span>

	<span class="nt">&lt;servlet&gt;</span>
		<span class="nt">&lt;servlet-name&gt;</span>appServlet<span class="nt">&lt;/servlet-name&gt;</span>
		<span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
		<span class="nt">&lt;init-param&gt;</span>
			<span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
			<span class="nt">&lt;param-value&gt;</span>/WEB-INF/spring/servlet-context.xml<span class="nt">&lt;/param-value&gt;</span>
		<span class="nt">&lt;/init-param&gt;</span>
		<span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
	<span class="nt">&lt;/servlet&gt;</span>
	<span class="nt">&lt;servlet-mapping&gt;</span>
		<span class="nt">&lt;servlet-name&gt;</span>appServlet<span class="nt">&lt;/servlet-name&gt;</span>
		<span class="nt">&lt;url-pattern&gt;</span>/<span class="nt">&lt;/url-pattern&gt;</span>
	<span class="nt">&lt;/servlet-mapping&gt;</span>
<span class="nt">&lt;/web-app&gt;</span>
</code></pre></div></div>

<p>web.xml을 살펴보면 DispatcherSevlet이 명시되어 있고 contextConfigLocation이 servlet-context.xml로 설정된것을 확인할 수 있습니다.</p>

<h3 id="servlet-contextxml">servlet-context.xml</h3>
<p>web.xml을 통해 servlet의 기본설정이 이루어지는 servlet-context의 경로를 명시했습니다.</p>
<ul>
  <li>여기서 사용하는 스프링 구성요소의 위치(context-component-scan)</li>
  <li>템플릿으로 thymeleaf를 설정</li>
  <li>컨트롤러에서 템플릿을 반환하기 위해 resolver 설정</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
	<span class="na">xmlns:mvc=</span><span class="s">"http://www.springframework.org/schema/mvc"</span>
	<span class="na">xmlns:tx=</span><span class="s">"http://www.springframework.org/schema/tx"</span>
	<span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
	<span class="na">xmlns:aop=</span><span class="s">"http://www.springframework.org/schema/aop"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context
		http://www.springframework.org/schema/context/spring-context.xsd
		http://www.springframework.org/schema/tx
		http://www.springframework.org/schema/tx/spring-tx.xsd
		http://www.springframework.org/schema/mvc
		http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span><span class="nt">&gt;</span>

	<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"io.youngwon.web"</span> <span class="nt">/&gt;</span>

	
	<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.thymeleaf.spring5.view.ThymeleafViewResolver"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"characterEncoding"</span> <span class="na">value=</span><span class="s">"UTF-8"</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"templateEngine"</span> <span class="na">ref=</span><span class="s">"templateEngine"</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"order"</span> <span class="na">value=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"templateEngine"</span> <span class="na">class=</span><span class="s">"org.thymeleaf.spring5.SpringTemplateEngine"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"templateResolver"</span> <span class="na">ref=</span><span class="s">"templateResolver"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"templateResolver"</span> 
		<span class="na">class=</span><span class="s">"org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"prefix"</span> <span class="na">value=</span><span class="s">"/WEB-INF/views/"</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"suffix"</span> <span class="na">value=</span><span class="s">".html"</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"templateMode"</span> <span class="na">value=</span><span class="s">"HTML5"</span> <span class="nt">/&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"characterEncoding"</span> <span class="na">value=</span><span class="s">"UTF-8"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div></div>

<h3 id="homecontroller">HomeController</h3>
<p>servlet-context.xml에서 프로젝트 스캔에 대한 베이스 패키지로 io.youngwon.web으로 지정하였습니다. 해당 경로에 HomeController를 생성합니다.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">io.youngwon.web</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HomeController</span> <span class="o">{</span>
	
	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">home</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">"home"</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="html">HTML</h3>
<p>servlet의 resolver를 보면 prefix로 /WEB-INF/views/가 지정된것을 확인할 수 있습니다. 해당 경로에 컨트롤러(HomeController)에서 반환된 home에 대한 html파일을 추가합니다.</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns:th=</span><span class="s">"http://www.thymeleaf.org"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;title&gt;</span>Welcome!<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
	안녕하세요
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>실행을 하고 해당 프로젝트의 / 경로에 접근해 보면 안녕하세요 라는 텍스트가 출력되는 것을 확인할 수 있습니다.</p>

<h3 id="프로젝트-구조">프로젝트 구조</h3>
<p><img src="/public/spring/08-web-project-structure.png" alt="" /></p>

<h1 id="references">References</h1>
<ul>
  <li>https://spring.io/guides/gs/multi-module/</li>
  <li>https://cloud.google.com/appengine/docs/standard/java/config/webxml?hl=ko</li>
</ul>

  </article>

  <hr>

  <!-- <div class="question">
    <h2>Questions?</h2>
    <p>Have a question regarding the post above? <br />Or any of my designs?</p>
    

  </div> -->

  <!-- <div class="related">
    <h2>Related</h2>
    
      <li><a href="/%EB%8F%84%EC%BB%A4/docker-aws-travis/" title="도커와 AWS기반으로 CI환경 구축하기">도커와 AWS기반으로 CI환경 구축하기
       &nbsp; <span class="post-meta">January 30, 2021</span></a>
    
      <li><a href="/%EB%8F%84%EC%BB%A4/docker-swarm/" title="도커 스웜(Docker Swarm)">도커 스웜(Docker Swarm)
       &nbsp; <span class="post-meta">January 28, 2021</span></a>
    
      <li><a href="/micro-service-from-scratch/" title="Micro Service From Scratch">Micro Service From Scratch
       &nbsp; <span class="post-meta">January 24, 2021</span></a>
    
  </div> -->

  
  

</div>

        </div>
        <footer class="site-footer">
<p class="small">YOUNGWON &copy 2021
</p>
</footer>

    </div>

    <script src="//cdn.jsdelivr.net/headroomjs/0.5.0/headroom.min.js"></script>
    <script type="text/javascript">
      var el = document.querySelector(".header-container");
      var headroom  = new Headroom(el, {
        "offset": 205,
        "tolerance": 5
      });
      headroom.init();
    </script>


    <!-- Twitter Shizzle -->
    <script type="text/javascript">
    window.twttr = (function (d, s, id) {
      var t, js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src= "https://platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js, fjs);
      return window.twttr || (t = { _e: [], ready: function (f) { t._e.push(f) } });
    }(document, "script", "twitter-wjs"));
    </script>

  </body>
</html>
