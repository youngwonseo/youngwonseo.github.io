<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      순환 신경망 &middot; Youngwon Seo
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
</head>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118401942-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118401942-1');
</script>

  <body>
    <nav class="nav">
      <div class="nav-container">
        <a href="/">
          <h2 class="nav-title">Youngwon Seo</h2>
        </a>
        <ul>
          <li><a href="/about">About</a></li>
          <li><a href="/">Posts</a></li>
          <li><a href="/study"/>Study</a></li>
          <li><a href="/ml"/>Machine Learning</a></li>
          <li><a href="/cicd"/>CI/CD</a></li>
          <!-- <li><a href="/spring"/>Spring</a></li>
          <li><a href="/deeplearning"/>Deeplearning</a></li> -->
        </ul>
    </div>
  </nav>

    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        Youngwon Seo
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2019-11-15 00:00:00 +0900">November 15, 2019</time>
    
  </div>

  <h1 class="post-title">순환 신경망</h1>
  <div class="post-line"></div>

  <p>이번장에서는 텍스트(단어의 시퀀스 또는 문자의 시퀀스), 시계열 또는 시퀀스 데이터를 처리하는 딥러닝 모델을 살펴봅니다. 기본적으로 시퀀스 데이터 처리를 위한 딥러닝 모델은 순환 신경망(recurrent neural network)과 1D 컨브넷(1D convnet)입니다.</p>

<p>먼저 가장 대표적인 시퀀스 데이터인 텍스트(문장 및 단어)를 다뤄보겠습니다.</p>

<h2 id="1-텍스트-데이터-다루기">1. 텍스트 데이터 다루기</h2>
<p>텍스트 패턴인식</p>

<p>다음은</p>
<ul>
  <li>텍스트를 단어로 나누고 각 단어를 하나의 백터로 변환</li>
  <li>텍스트를 문자로 나누고 각 문자를 하나의 백터로 변환</li>
  <li>텍스트에서 단어나 문자의 n-그램을 추출하여 각 n-그램을 하나의 백터로 변환</li>
</ul>

<p>텍스트를 나누는 이런 단위(단어, 문자, n-그램)를 토큰(나누는 작업은 토큰화, tokenization)이라 합니다. 텍스트 백터화 과정은 이런 토큰화를 통해 생성되는 각 토큰을 백터화하는 것입니다. 여기서는 다음과 같은 토큰-&gt;백터화 방법을 소개합니다.</p>

<ul>
  <li>원-핫 인코딩(one-hot encoding)</li>
  <li>토큰 임베딩(token embedding)</li>
</ul>

<h3 id="11-원-핫-인코딩">1.1 원-핫 인코딩</h3>
<p>먼저 살펴볼 원-핫 인코딩 방식은 3장의 영화리뷰(IMDB)나 뉴스기사(로이터)를 분류하기 위해 사용된 방법입니다. 이 방법은 원하는 토큰 단위에 따라 고유한 인덱스를 부여하고 각 토큰에 해당 인덱스만 1로 구성된 백터로 변환합니다.</p>

<p>코드를 살펴봅시다.</p>

<h4 id="단어단위-원-핫-인코딩">단어단위 원-핫 인코딩</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s">'The cat sat on the mat.'</span><span class="p">,</span> <span class="s">'The dog ate my homework.'</span><span class="p">]</span>

<span class="n">token_index</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sample</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">token_index</span><span class="p">:</span>
      <span class="n">token_index</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">token_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">#단어마다 인덱스 할당, 인덱스는 1씩 증가</span>

<span class="n">max_length</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span> <span class="n">max_length</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">token_index</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">split</span><span class="p">()))[:</span><span class="n">max_length</span><span class="p">]:</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">token_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
</code></pre></div></div>
<p>예제를 위해 간단한 두개의 문장이 존재합니다. 먼저 token_index는 각 단어가 나타내는 인덱스를 표현합니다. 다음과 같이 입력되어 있습니다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="s">'The'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s">'ate'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
 <span class="s">'cat'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s">'dog'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
 <span class="s">'homework.'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
 <span class="s">'mat.'</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
 <span class="s">'my'</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
 <span class="s">'on'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
 <span class="s">'sat'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s">'the'</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
</code></pre></div></div>
<p>dict의 키로 단어가 입력되고 각 단어별 인덱스가 할당된 형태입니다.</p>

<p>max_length는 각 문장이 원-핫 백터로 인코딩될때 10개의 단어를 표현하는 백터로 변환한다는 의미입니다. 즉 첫번째 문장은 단어가 6개로 이루어 져 있으므로 각 단어가 하나의 백터로 표현되면 다음과 같이 나머지 비어있는 4개의 영백터가 추가됩니다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>    <span class="c">#The의 1을 의미</span>
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>   <span class="c">#cat의 2를 의미</span>
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>   <span class="c">#단어가 6개 밖에없어 전부 0으로 채워진 영백터로 max_length까지 표현</span>
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> 
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
</code></pre></div></div>
<p>그리고 만약 단어가 15개로 이루어져 있는 문장을 위와 같이 인코딩한다면 뒤에 5개의 단어는 짤리게 됩니다.</p>

<p>아래의 코드는 단어가 아닌 문자기준으로 표현하는 원-핫 인코딩 방식의 코드입니다.</p>

<h4 id="문자단위-원-핫-인코딩">문자단위 원-핫 인코딩</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">string</span>

<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s">'The cat sat on the mat.'</span><span class="p">,</span> <span class="s">'The dog ate my homework.'</span><span class="p">]</span>
<span class="n">characters</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span>
<span class="n">token_index</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">characters</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">characters</span><span class="p">))))</span>

<span class="n">max_length</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span> <span class="n">max_length</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">token_index</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">character</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">token_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">character</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
</code></pre></div></div>
<p>여기서는 총 50개의 문자를 가지는 문자열을 포함했습니다. token_index의 일부만 살펴보겠씁니다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">:</span> <span class="mi">96</span><span class="p">,</span>
 <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">:</span> <span class="mi">97</span><span class="p">,</span>
 <span class="s">'</span><span class="se">\x0b</span><span class="s">'</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span>
 <span class="s">'</span><span class="se">\r</span><span class="s">'</span><span class="p">:</span> <span class="mi">98</span><span class="p">,</span>
 <span class="s">' '</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span>
 <span class="s">'!'</span><span class="p">:</span> <span class="mi">63</span><span class="p">,</span>
 <span class="s">'"'</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
 <span class="s">'#'</span><span class="p">:</span> <span class="mi">65</span><span class="p">,</span>
 <span class="s">'$'</span><span class="p">:</span> <span class="mi">66</span><span class="p">,</span>
 <span class="o">...</span>
 <span class="s">'5'</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
 <span class="s">'6'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
 <span class="s">'7'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
 <span class="s">'8'</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
 <span class="s">'9'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
 <span class="o">...</span>
  <span class="s">'S'</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
 <span class="s">'T'</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span>
 <span class="s">'U'</span><span class="p">:</span> <span class="mi">57</span><span class="p">,</span>
 <span class="s">'V'</span><span class="p">:</span> <span class="mi">58</span><span class="p">,</span>
 <span class="s">'W'</span><span class="p">:</span> <span class="mi">59</span><span class="p">,</span>
 <span class="s">'X'</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
 <span class="s">'Y'</span><span class="p">:</span> <span class="mi">61</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>
<p>영어도 있고 숫자도 있고 특수문자나 이스케이프문자(\n 등)도 포함되어 있습니다.</p>

<h4 id="케라스를-사용한-원-핫-인코딩">케라스를 사용한 원-핫 인코딩</h4>

<p>다음은 케라스 API를 사용한 원-핫 인코딩의 코드입니다. 설명은 주석으로 대체합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras.preprocessing.text</span> <span class="kn">import</span> <span class="n">Tokenizer</span>

<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s">'The cat sat on the mat.'</span><span class="p">,</span> <span class="s">'The dog ate my homework.'</span><span class="p">]</span>

<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> <span class="c">#가장 빈도가 높은 단어 1000개를 사용하도록 합니다.</span>
<span class="n">tokenizer</span><span class="o">.</span><span class="n">fit_on_texts</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="c">#단어인덱스를 만듭니다. tokenizer에 만들어집니다.</span>

<span class="n">sequences</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">texts_to_sequences</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>  <span class="c">#문장을 단어인덱스의 인덱스로 표현합니다. 첫 번째 문장의 경우 [1, 2, 3, 4, 1, 5] 이렇게 표현, 각 인덱스는 각 단어</span>

<span class="n">one_hot_results</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">texts_to_matrix</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'binary'</span><span class="p">)</span> <span class="c">#인덱스의 시퀀스로 표현된 문장을 원핫으로 인코딩 합니다.</span>

<span class="n">word_index</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">word_index</span> <span class="c">#단어 인덱스가 word_index에 포함되어 있습니다. 이전 코드의 token_index처럼 각 단어가 키이고 고유인덱스가 값으로 구성된 dict입니다.</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="si">%</span><span class="s">s개의 고유한 토큰을 찾았습니다.'</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_index</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="원-핫-해싱">원-핫 해싱</h3>
<p>원-핫 인코딩의 변종인 원-핫 해싱(one-hot hashing)이 존재합니다. 이 방식은 고유한 토큰수(단어 또는 문자)가 너무 커서 토큰에 대한 백터가 너무 클때 사용됩니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="s">'The cat sat on the mat.'</span><span class="p">,</span> <span class="s">'The dog ate my homework.'</span><span class="p">]</span>

<span class="n">dimensionality</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c">#최대 1000개의 단어를 표현하는 백터를 의미</span>
<span class="n">max_length</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span> <span class="n">max_length</span><span class="p">,</span> <span class="n">dimensionality</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">split</span><span class="p">()))[:</span><span class="n">max_length</span><span class="p">]:</span> <span class="c">#문장에서 최대 10개의 토큰을 표현</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">word</span><span class="p">))</span> <span class="o">%</span> <span class="n">dimensionality</span> <span class="c"># token_index를 미리 생성하는것이 아니라 해시를 사용해서 index를 부여</span>
    <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">1.</span>
</code></pre></div></div>
<p>최대 1000개 이지만 그 이상의 단어가 표현될 경우 충돌이 발생합니다.</p>

<h3 id="12-단어-임베딩-사용하기">1.2 단어 임베딩 사용하기</h3>
<p>단어를 백터로 표현하는 또 다른 방법은 단어 임베딩입니다. 원핫인코딩을 생각해 봅시다. 단어가 1000가지 라면 하나의 토큰을 표현하는데 1000개의 원소를 가진 백터가 필요합니다. 거기에다 단 하나의 인덱스에만 1이 입력되어 있고 나저미는 0이 채워집니다. 하나의 토큰을 표현하기 위해 생각보다 많은 메모리를 사용하죠. 단어 임베딩은 이러한 원핫인코딩과 다르게 고정된 백터를 사용하고 1이나 0이 아닌 실수의 집합으로 단어를 표현하는 방식입니다.</p>

<p>단어임베딩은</p>

<h4 id="사전-훈련된-단어-임베딩-사용하기">사전 훈련된 단어 임베딩 사용하기</h4>

<h2 id="2-순환-신경망-이해하기">2. 순환 신경망 이해하기</h2>

<h2 id="3">3.</h2>


  
  <div class="post-disqus">
      <section id="disqus_thread"></section>
      <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://youngwonseo.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
  </div>
  
</div>

<div class="pagination">
  
    <a href="/2019/11/15/06-02-keras/" class="left arrow">&#8592;</a>
  
  
    <a href="/2019/11/15/03-informed_search/" class="right arrow">&#8594;</a>
  

  <a href="#" class="top">Top</a>
</div>

    </main>

    <footer>
      <span>
        &copy; <time datetime="2019-11-20 13:39:58 +0900">2019</time> Youngwon Seo. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
      </span>
    </footer>
  </body>
</html>
