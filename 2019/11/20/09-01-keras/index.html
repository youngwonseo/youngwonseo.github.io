<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta https-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <title>결론 #1</title>
  <meta name="description" content="책의 마지막장인 결론의 내용입니다.">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://youngwonseo.github.io/2019/11/20/09-01-keras/">
  <link rel="alternate" type="application/atom+xml" title="YoungWon" href="https://youngwonseo.github.io/feed.xml" />
</head>

  <body>
    

<div class="header-container" id="header-container">

<!-- Site navigation -->
  <nav class="site-nav">
    <div class="trigger">
      
        
        <a class="page-link" href="/about/">About</a>
        
      
        
        <a class="page-link" href="/archive/">Archive</a>
        
      
        
      
        
      
        
        <a class="page-link" href="/projects/">Projects</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      <a class="page-link" href="/feed.xml">RSS</a>
      <!-- <a class="twitter page-link" href="httpss://twitter.com/fffabs"><span class="icon-twitter"></span></a>
      <a class="facebook page-link" href="httpss://www.facebook.com/fffabs"><span class="icon-facebook"></span></a> -->
    </div>
  </nav>

  <!-- The title of the site -->
  <header class="site-header">
    <!-- <a href="/">
      <div class="trigger">
        <img src="/assets/images/avatar.png" />
      </div>
    </a> -->
    <a class="site-title" href="/">YoungWon</a> -->
  </header>

</div>

      <div class="wrapper">
        <div class="page-content">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">결론 #1</h1>
    <p class="post-meta">November 20, 2019 • Youngwon Seo</p>
  </header>

  <!-- Beginning Twitter sharing Large button -->
  <!-- <a class="twitter-share-button" href="httpss://twitter.com/share"
  data-related="twitterdev"
  data-size="large"
  data-count="horizontal">
  Tweet
  </a> -->
  <!-- End of Twitter sharing button -->

  <!-- Facebook -->
  

  <article class="post-content">
    <p>책의 마지막장인 결론의 내용입니다.</p>

<h2 id="핵심-개념-리뷰">핵심 개념 리뷰</h2>
<p>먼저 AI와 딥러닝의 관계를 다음과 같이 표현할 수 있습니다.</p>

<h3 id="ai--머신러닝--딥러닝">AI &gt; 머신러닝 &gt; 딥러닝</h3>
<p><strong>AI(인공지능)</strong>는 인지 과정을 자동화하기 위한 모든 방법입니다. <strong>머신러닝</strong>은 훈련데이터를 사용해서 인지 과정을 자동화하는 AI의 하위 개념입니다. 여기서 훈련데이터를 사용한다는 것은 훈련데이터를 학습한다는 의미 입니다. <strong>딥러닝</strong>은 머신러닝의 일부로써 기하학적 변환 함수들이 번갈아 가며 연속적으로 길게 연결된 모델입니다. 기하학적 변환 함수는 모델을 구성하는 층에 의해 결정되고 입력을 제외한 변환함수의 피연산자는 학습되는 가중치들입니다. 즉 학습을 한다는 것은 우리가 원하는 변환을 만들어내는 가중치를 찾는것입니다.</p>

<h3 id="딥러닝">딥러닝</h3>
<p>충분한 데이터와 하드웨어의 발전으로 딥러닝은 많은 분야에서 가장 좋은 성능을 내는 기술로 자리 잡고 있습니다. 딥러닝에서 가장 놀라운 점은 단순함에 있습니다. 모델을 학습하는 <strong>경사 하강법</strong>이 데이터가 충분해지면서 사람의 인지능력을 뛰어 넘는 모델을 만드는 것이죠.</p>

<p>딥러닝의 모든것은 벡터입니다. 입력되는 데이터(학습할 데이터, 샘플, 타켓을 포함)를 벡터로 표현하고 기하학적변환을 주어진 층에서 구성합니다. 하나하나를 보면 단순한 연산이지만 여러단계가 조합되어 샘플을 타켓으로 매핑(샘플 데이터를 표현하는 공간을 타켓 데이터를 표현하는 공간으로 기하학적 변환)하는 모델을 만들어(학습) 내는것입니다.</p>

<p>기하학적 변환은 뭉쳐진 종이공을 펼치는 것과 비슷합니다. 뭉쳐진 종이 공은 모델이 처음 보게 되는 입력데이터의 <strong>메니폴드</strong>입니다. 딥러닝 모델의 각 층이 종이공을 조금식 펼치는것과 같죠. 딥러닝 모델은 고차원 데이터의 복잡한 메니폴드를 펼치는 수학 장치입니다.</p>

<p>이를 위해 필요한 것은 <strong>기하학적 변환이 미분가능</strong>해야 한다는 점과 원본 데이터에 있는 <strong>모든 형태의 관계를 찾기 위해 충분히 큰 고차원 공간</strong>입니다.</p>

<h3 id="머신러닝-작업-흐름">머신러닝 작업 흐름</h3>
<ol>
  <li>문제 정의, 사용할 수 있는 데이터셋, 예측 대상 등</li>
  <li>목표 달성을 측정하기 위해 신뢰할 수 이쓴ㄴ 방법 탐색 (예측 정확도, 다른 기법을 사용한 성능)</li>
  <li>모데 평가를 위한 검증 과정 준비(훈련, 검증, 테스트 세트 정의)</li>
  <li>데이터를 모델에 입력하기 위한 백터화 및 전처리</li>
  <li>천 번째 모델 만들기</li>
  <li>하이퍼파라미터 튜닝, 정규화, 이때 검증데이터의 성능만으로 튜닝(과적합도 고려)</li>
  <li>테스트셋으로 성능평가(테스트셋으로 성능평가 후 튜닝등의 추가 작업은 안됨)</li>
</ol>

<h3 id="네트워크-구조-및-데이터에-대한-구조선택">네트워크 구조 및 데이터에 대한 구조선택</h3>
<p>이 책에서는 완전 연결 네트워크, 합성곱 네트워크, 순환 네트워크를 살펴보았습니다. 네크워크 구조에 대한 요약을 살펴보겠습니다.</p>
<ul>
  <li>네트워크 구조는 데이터 구조에 대한 가정을 담고 있다</li>
  <li>좋은 모델을 탐색하기 위한 가설 공간</li>
  <li>데이터 구조와 네트워크 구조의 가정 사이가 잘 맞는지에 따라 잘 작동하는지가 달라짐</li>
</ul>

<h4 id="데이터에-대한-구조선택">데이터에 대한 구조선택</h4>
<ul>
  <li>백터 데이터 : 완전 연결 네트워크</li>
  <li>이미지 데이터 : 2D 컨브넷</li>
  <li>사운드 데이터 : 1D컨브넷(권장)이나 RNN</li>
  <li>텍스트 데이터 : 컨브넷(권장)이나 RNN</li>
  <li>시계열 데이터 : RNN(권장)이나 1D 컨브넷</li>
  <li>다른 종류의 시퀀스 데이터: RNN이나 1D컨브넷, 데이터의 순서에 중요한 의미가 있다면 RNN 권장</li>
  <li>비디오 데이터 : 3D 컨브넷(연속동작을 감지할 필요가 있다면), 프레임별 2D 컨브넷 후 RNN또는 1D컨브넷</li>
  <li>볼륨을 가진 데이터 : 3D컨브넷</li>
</ul>

<h3 id="네트워크-구조별-특징">네트워크 구조별 특징</h3>
<h4 id="완전-연결-네트워크">완전 연결 네트워크</h4>
<p>완전 연결 네트워크는 백터 데이터를 처리하는 Dense층을 쌓은 것입니다. 이런 네트워크는 입력 특성에 특별한 가정을 두지 않습니다. 이층은 모든 입력특성간에 관계를 매칭합니다.</p>

<h4 id="완전-연결-네트워크-사용">완전 연결 네트워크 사용</h4>
<p>범주형 데이터에 많이 사용되고 분류나 회귀 출력을 위해 다른 네트워크의 최종 단계에서 사용됩니다. 각 상황에 대해 케라스는 다음과 같이 사용됩니다.</p>

<ul>
  <li>단일 레이블 이중 분류
    <pre><code class="language-python">model = models.Sequential()
model.add(layers.Dense(32, activation='relu', input_shape=(num_input_features,)))
model.add(layers.Dense(32, activation='relu'))
model.add(layers.Dense(1, activation='sigmoid'))
model.compile(optimizer='rmsprop', loss='binary_crossentropy')
</code></pre>
  </li>
  <li>단일 레이블 다중 분류
    <pre><code class="language-python">model = models.Sequential()
model.add(layers.Dense(32, activation='relu', input_shape=(num_input_features,)))
model.add(layers.Dense(32, activation='relu'))
model.add(layers.Dense(num_classes, activation='softmax'))
model.compile(optimizer='rmsprop', loss='categorical_crossentropy')
</code></pre>
  </li>
  <li>다중 레이블 다중 분류(타겟이 k-핫 인코딩 되어있어야 함, 사이킷런의 MultiLabelBinarizer를 사용하면 쉽게 적용 가능)
    <pre><code class="language-python">model = models.Sequential()
model.add(layers.Dense(32, activation='relu', input_shape=(num_input_features,)))
model.add(layers.Dense(32, activation='relu'))
model.add(layers.Dense(num_classes, activation='sigmoid'))
model.compile(optimizer='rmsprop', loss='binary_crossentropy')
</code></pre>
  </li>
  <li>회귀
    <pre><code class="language-python">model = models.Sequential()
model.add(layers.Dense(32, activation='relu', input_shape=(num_input_features,)))
model.add(layers.Dense(32, activation='relu'))
model.add(layers.Dense(num_values))
model.compile(optimizer='rmsprop', loss='mse')
</code></pre>
  </li>
</ul>

<h4 id="컨브넷">컨브넷</h4>
<p>컨브넷은 입력 텐서의 여러 위치에 동일한 기하학적 변환을 적용하여 공간 방향의 지역 패턴을 찾습니다. 이는 <strong>이동 불편성</strong>을 가진 표현을 만들어 합성곱층을 데이터 효율적으로 만들고 모듈화 합니다. 1D(시퀀스), 2D(이미지), 3D(볼륨) 등 어느 차원의 공간에서도 적용가능합니다.</p>

<p>컨브넷은 <strong>합성곱</strong>과 <strong>최대 풀링</strong> 층이 쌓여 구성됩니다. 풀링 층은 데이터를 다운샘플링합니다(층마다 학습되는 특징맵을 크기를 일정하게 맞춰주는 역활을 합니다.). 마지막에는 플랫튼되고 완전연결층으로 구성되어 입력데이터에 대한 타켓을 매핑합니다.</p>

<p>추가적으로 더 빠르고 효율적으로 표현을 학습하는 깊이별 분할 합성곱이 존재합니다.</p>

<p>다음은 전형적인 이미지 분류에 대한 케라스코드입니다.</p>
<pre><code class="language-python">model = models.Seqeuential()
model.add(layers.SeparableConv2D(32, activation='relu', input_shape=(height, width, channels)))
model.add(layers.SeparableConv2D(64, 3, activation='relu'))
model.add(layers.MaxPooling2D(2))

model.add(layers.SeparableConv2D(64, 3, activation='relu'))
model.add(layers.SeparableConv2D(128, 3, activation='relu'))
model.add(layers.MaxPooling2D(2))

model.add(layers.SeparableConv2D(64, 3, activation='relu'))
model.add(layers.SeparableConv2D(128, 3, activation='relu'))
model.add(layers.MaxPooling2D(2))

model.add(layers.Dense(32, activation='relu'))
model.add(layers.Dense(num_classes, activation='softmax'))

model.compile(optimizer='rmsprop', loss='categorical_crossentropy')
</code></pre>

<h4 id="rnn">RNN</h4>

<pre><code class="language-python">model = models.Sequential()
model.add(layers.LSTM(32, input_shape=(num_timesteps, num_features)))
model.add(layers.Dense(num_classes, activation='sigmoid'))

model.compile(optimizer='rmsprop', loss='binary_crossentropy')
</code></pre>

<p>다음은 벡터 시퀀스의 이진분류를 위한 RNN모델입니다.</p>
<pre><code class="language-python">model = models.Sequential()
model.add(layers.LSTM(32, return_sequences=True, input_shape=(num_timesteps, num_features)))
model.add(layers.LSTM(32, return_sequences=True))
model.add(layers.Dense(num_classes, activation='sigmoid'))

model.compile(optimizer='rmsprop', loss='binary_crossentropy')
</code></pre>


  </article>

  <hr>

  
    <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: httpss://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'httpss://youngwonseo.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="httpss://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
  
  <!-- <div class="question">
    <h2>Questions?</h2>
    <p>Have a question regarding the post above? <br />Or any of my designs?</p>
    <a class="twitter-follow-button"
    href="httpss://twitter.com/fffabs"
    data-show-count="true"
    data-size="large">
    Follow @fffabs
    </a>
    <script type="text/javascript">
    window.twttr = (function (d, s, id) {
      var t, js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src= "httpss://platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js, fjs);
      return window.twttr || (t = { _e: [], ready: function (f) { t._e.push(f) } });
    }(document, "script", "twitter-wjs"));
    </script>
  </div> -->

  <div class="related">
    <h2>Related</h2>
    
      <li><a href="/2020/11/11/detecting-aortic-stenosis-using-electrocardiography/" title="Detecting Aortic Stenosis Using Electrocardiography">Detecting Aortic Stenosis Using Electrocardiography
       &nbsp; <span class="post-meta">November 11, 2020</span></a>
    
      <li><a href="/2020/10/09/image-resize/" title="파이썬 이미지 리사이즈">파이썬 이미지 리사이즈
       &nbsp; <span class="post-meta">October 09, 2020</span></a>
    
      <li><a href="/2020/09/22/class-activation-map/" title="Learning Deep Features for Discriminative Localization">Learning Deep Features for Discriminative Localization
       &nbsp; <span class="post-meta">September 22, 2020</span></a>
    
  </div>

</div>

        </div>
        <footer class="site-footer">
<p class="small">YoungwonSeo &copy 2020
</p>
</footer>

    </div>

    <script src="//cdn.jsdelivr.net/headroomjs/0.5.0/headroom.min.js"></script>
    <script type="text/javascript">
      var el = document.querySelector(".header-container");
      var headroom  = new Headroom(el, {
        "offset": 205,
        "tolerance": 5
      });
      headroom.init();
    </script>


    <!-- Twitter Shizzle -->
    <!-- <script type="text/javascript">
    window.twttr = (function (d, s, id) {
      var t, js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src= "httpss://platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js, fjs);
      return window.twttr || (t = { _e: [], ready: function (f) { t._e.push(f) } });
    }(document, "script", "twitter-wjs"));
    </script> -->
    	<!-- Google Analytics -->
  <script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','httpss://www.google-analytics.com/analytics.js','ga');
		
		ga('create', 'UA-78263144-1', 'auto');
		ga('send', 'pageview');
		</script>
		<!-- End Google Analytics -->
</header>


  </body>
</html>
