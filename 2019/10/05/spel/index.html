<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      Spring Expressino Language(SpEL) &middot; Youngwon Seo
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
</head>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118401942-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118401942-1');
</script>

  <body>
    <nav class="nav">
      <div class="nav-container">
        <a href="/">
          <h2 class="nav-title">Youngwon Seo</h2>
        </a>
        <ul>
          <li><a href="/about">About</a></li>
          <li><a href="/">Posts</a></li>
          <li><a href="/study"/>Study</a></li>
          <li><a href="/ml"/>Machine Learning</a></li>
          <li><a href="/cicd"/>CI/CD</a></li>
          <!-- <li><a href="/spring"/>Spring</a></li>
          <li><a href="/deeplearning"/>Deeplearning</a></li> -->
        </ul>
    </div>
  </nav>

    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        Youngwon Seo
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2019-10-05 00:00:00 +0900">October 05, 2019</time>
    
  </div>

  <h1 class="post-title">Spring Expressino Language(SpEL)</h1>
  <div class="post-line"></div>

  <ul>
  <li>SpEL(Spring Expression Language)는 run time환경에서 Object graph에 대해  질의하고 관리하는 강력한 표현 언어</li>
  <li>
    <p>Unified EL과 syntax가 유사, 그러나 더 많은 특성을 제공(메소드 호출), 기본 문자열 템플릿)</p>
  </li>
  <li>자바에는 여러가지 표혀언어가 가능
    <ul>
      <li>OGNL, MVEL, JBossEL 등</li>
    </ul>
  </li>
  <li>지원 기능
    <ul>
      <li>Literal expressions</li>
      <li>Boolean and relational operators</li>
      <li>Regular expression</li>
      <li>Class expressions</li>
      <li>Accessing properties, arrays, lists, and maps</li>
      <li>Method invocation</li>
      <li>Relational operations</li>
      <li>Assignment</li>
      <li>Calling constructors</li>
      <li>Bean references</li>
      <li>Inline lists</li>
      <li>Inline maps</li>
      <li>Ternary operator</li>
      <li>Variables</li>
      <li>User-defined functions</li>
      <li>Collection projection</li>
      <li>Collection selection</li>
      <li>Templated expressions</li>
    </ul>
  </li>
</ul>

<h2 id="41-evaludation">4.1 Evaludation</h2>
<ul>
  <li>이번 절에서 SpEL interface와 expression language의 심플한 사용법을 소개</li>
  <li>
    <p>완전한 사용법은 4.3을 참조</p>
  </li>
  <li>다음은 스트링표현을 평가하는 SpEL API(스트링 -&gt; ‘Hello World’)
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ExpressionParser</span> <span class="n">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SpelExpressionParser</span><span class="o">();</span>
<span class="n">Expression</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="na">parseExpression</span><span class="o">(</span><span class="s">"'Hello World'"</span><span class="o">);</span> 
<span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">exp</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>대부분의 SpEL 클래스와 인터페이스는 org.springframework.expression와 이것의 서브 패키지인 spel.support에서 제공</p>
  </li>
  <li>ExpressionParser 인터페이스는 expression string을 파싱함</li>
  <li></li>
  <li>다음예제는 메소드(concat) 호출에 대한 예제
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ExpressionParser</span> <span class="n">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SpelExpressionParser</span><span class="o">();</span>
<span class="n">Expression</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="na">parseExpression</span><span class="o">(</span><span class="s">"'Hello World'.concat('!')"</span><span class="o">);</span> 
<span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">exp</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
</code></pre></div>    </div>
  </li>
  <li>다음예제는 JavaBean의 bytes를 호출 (getBytes())
```java
ExpressionParser parser = new SpelExpressionParser();</li>
</ul>

<p>// invokes ‘getBytes()’
Expression exp = parser.parseExpression(“‘Hello World’.bytes”); 
byte[] bytes = (byte[]) exp.getValue();</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
* 중첩되는 속성들도 접근가능(prop1.prop2.prop3)
```java
ExpressionParser parser = new SpelExpressionParser();

// invokes 'getBytes().length'
Expression exp = parser.parseExpression("'Hello World'.bytes.length"); 
int length = (Integer) exp.getValue();
</code></pre></div></div>

<ul>
  <li>생성자도 사용가능
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ExpressionParser</span> <span class="n">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SpelExpressionParser</span><span class="o">();</span>
<span class="n">Expression</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="na">parseExpression</span><span class="o">(</span><span class="s">"new String('hello world').toUpperCase()"</span><span class="o">);</span> 
<span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>generic의 getValue(public <T> T getValue(Class<T> desiredResultType))를 사용할 경우 캐스팅이 필요없음</T></T></p>
  </li>
  <li>```java
// Create and set a calendar
GregorianCalendar c = new GregorianCalendar();
c.set(1856, 7, 9);</li>
</ul>

<p>// The constructor arguments are name, birthday, and nationality.
Inventor tesla = new Inventor(“Nikola Tesla”, c.getTime(), “Serbian”);</p>

<p>ExpressionParser parser = new SpelExpressionParser();</p>

<p>Expression exp = parser.parseExpression(“name”); 
String name = (String) exp.getValue(tesla);
// name == “Nikola Tesla”</p>

<p>exp = parser.parseExpression(“name == ‘Nikola Tesla’”);
boolean result = exp.getValue(tesla, Boolean.class);
// result == true</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

```java
class Simple {
    public List&lt;Boolean&gt; booleanList = new ArrayList&lt;Boolean&gt;();
}

Simple simple = new Simple();
simple.booleanList.add(true);

EvaluationContext context = SimpleEvaluationContext.forReadOnlyDataBinding().build();

// "false" is passed in here as a String. SpEL and the conversion service
// will recognize that it needs to be a Boolean and convert it accordingly.
parser.parseExpression("booleanList[0]").setValue(context, simple, "false");

// b is false
Boolean b = simple.booleanList.get(0);
</code></pre></div></div>

<h2 id="42-expression-in-bean-definitions">4.2 Expression in Bean Definitions</h2>
<ul>
  <li>SpEL은 XML 기반 또는 어노테이션 기반(BeanDefinition 인스턴스 정의를 위한)으로 사용가능</li>
  <li>#{<expression string="">} &lt;- 구문으로 사용</expression></li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"numberGuess"</span> <span class="na">class=</span><span class="s">"org.spring.samples.NumberGuess"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"randomNumber"</span> <span class="na">value=</span><span class="s">"#{ T(java.lang.Math).random() * 100.0 }"</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- other properties --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"taxCalculator"</span> <span class="na">class=</span><span class="s">"org.spring.samples.TaxCalculator"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"defaultLocale"</span> <span class="na">value=</span><span class="s">"#{ systemProperties['user.region'] }"</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- other properties --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>

<h2 id="43-language-reference">4.3 Language Reference</h2>

<h2 id="44-classes-used-in-the-examples">4.4 Classes Used in the Examples</h2>


  
  <div class="post-disqus">
      <section id="disqus_thread"></section>
      <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://youngwonseo.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
  </div>
  
</div>

<div class="pagination">
  
    <a href="/2019/11/10/03-01-keras/" class="left arrow">&#8592;</a>
  
  
    <a href="/2019/10/01/06-svm/" class="right arrow">&#8594;</a>
  

  <a href="#" class="top">Top</a>
</div>

    </main>

    <footer>
      <span>
        &copy; <time datetime="2019-11-22 17:44:23 +0900">2019</time> Youngwon Seo. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
      </span>
    </footer>
  </body>
</html>
