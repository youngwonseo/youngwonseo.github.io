<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      메이븐 멀티모듈 #1 &middot; Youngwon Seo
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">
</head>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118401942-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118401942-1');
</script>

  <body>
    <nav class="nav">
      <div class="nav-container">
        <a href="/">
          <h2 class="nav-title">Youngwon Seo</h2>
        </a>
        <ul>
          <li><a href="/about">About</a></li>
          <li><a href="/">Posts</a></li>
          <li><a href="/study"/>Study</a></li>
          <li><a href="/ml"/>Machine Learning</a></li>
          <li><a href="/cicd"/>CI/CD</a></li>
          <!-- <li><a href="/spring"/>Spring</a></li>
          <li><a href="/deeplearning"/>Deeplearning</a></li> -->
        </ul>
    </div>
  </nav>

    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        Youngwon Seo
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2020-02-29 00:00:00 +0900">February 29, 2020</time>
    
  </div>

  <h1 class="post-title">메이븐 멀티모듈 #1</h1>
  <div class="post-line"></div>

  <p>본 포스트는 메이븐 멀티 모듈을 기반으로 스프링 부트 프로젝트를 구성하고 예제 프로젝트로 게시판을 개발을 합니다.</p>

<h2 id="메이븐-멀티-모듈">메이븐 멀티 모듈</h2>
<p>스프링기반의 웹 어플리케이션을 개발하다보면 하나의 프로젝트를 여러개로 분리해야할 경우가 존재합니다. Front-end와 Back-end처럼 수직적 개념이 아닌 여러개의 스프링 기반 서브 프로젝트(Spring Batch 등)를 하나의 프로젝트에 넣어서 운영하기는 부담스러울 경우가 있기 때문입니다. 최근에는 마이크로서비스(Microservice)등의 개념들이 도입되면서(최근이라기에는 이제는 묵시적 표준) 단순히 프로젝트의 속성이 아닌 기능별, 리소스별 프로젝트를 분리하여 배포 및 운영해야하는 필요성도 존재합니다.</p>

<p>스프링 기반으로 정산시스템을 만든다고 생각해 봅시다. 우리는 사용자에게 자신의 요금을 조회할 수 있는 웹 어플리케이션이 필요합니다. 또한 매달 또는 매주 한번씩 실행되는 배치 어플리케이션이 필요하죠. 이는 다음과 같이 표현할 수 있습니다.
<img src="/public/spring/01-multiple-spring.png" alt="" /></p>

<p>위와 같이 여러개의 프로젝트를 구성할 때 각 프로젝트에는 DB에 접근하는 Repository나 비즈니스 로직이 포함된 Service가 포함되는데 이는 중복코드를 발생시킬 위험이 존재합니다(위험이 이라고 포함되었지만 무조건 발생할 수 밖에 없습니다). 즉 동일한 도메인(Entity)이 사용되면 개발시 또는 수정시 copy&amp;paste 신동이 되어야할 수 밖에 없습니다. 이를 해결하기 위해 프로젝트를 분리해야 하는데 다음과 같은 방법을 사용할 수 있습니다.</p>
<ul>
  <li>공통 로직을 jar로 maven repo나 gradle repo로 배포</li>
  <li>공통 로직 담은 프로젝트를 IDE의 project explorer환경에서 import</li>
  <li>메이븐 멀티 모듈로 프로젝트를 구성</li>
</ul>

<p>첫 번째는 방법은 공통을 담고 있는 프로젝트를 구성하고 공통로직을 사용하는 프로젝트에서 maven이나 gradle로 import하는것입니다. 하지만 수정시 매번 재배포하고 import하는 프로젝트들을 테스트해야하는 불편함이 존재합니다. 두 번째 방법은 첫 번째 방법과 세 번째 방법의 사이에 존재하는데 IDE환경에서 프로젝트를 jar로 import해서 사용하는 방법입니다. 세 번째 방법은 같이 사용할 프로젝트를 메이픈 멀티 모듈로 구성해 각 프로젝트들이 동일한 로직이나 도메인을 사용할 때 같은 코드를 사용할 수 있도록 보장받는 것입니다.</p>

<p>위 프로젝트를 메이븐 멀티 모듈로 구성하면 다음과 같이 표현할 수 있습니다(API를 추가하였습니다).</p>

<p><img src="/public/spring/02-maven-multi-module.png" alt="" /></p>

<p>메이븐 멀티 모듈기반의 프로젝트를 개발하기 위해 CMS를 개발해 보겠습니다. CMS는 도메인이나 비즈니스 정보가 포함된 <strong>CORE</strong>, 사용자가 접근하는 <strong>WEB</strong>으로 구성되어 있습니다. 추후 RESTful API를 제공하는 <strong>API</strong> 프로젝트를 추가해 보겠습니다.</p>

<h4 id="개발환경">개발환경</h4>
<ul>
  <li>Spring Boot</li>
  <li>JPA</li>
  <li>STS4(ecplise)</li>
  <li>lombok</li>
</ul>

<h2 id="프로젝트-구성">프로젝트 구성</h2>
<p>최상위 프로젝트는 maven project이고 그 외 내부 프로젝트는 maven module입니다. 모두 simple project로 설정합니다.</p>

<ol>
  <li>cms 프로젝트 생성 (상위 프로젝트)
    <ul>
      <li>maven project로 생성</li>
      <li>create a simple project 체크</li>
      <li>패키징을 POM으로 선택</li>
    </ul>
  </li>
  <li>core 프로젝트 생성 (하위 프로젝트1)
    <ul>
      <li>상위 프로젝트에 대한 maven moule로 생성</li>
      <li>create a simple project 체크</li>
    </ul>
  </li>
  <li>web 프로젝트 생성 (하위 프로젝트2)
    <ul>
      <li>상위 프로젝트에 대한 maven moule로 생성</li>
      <li>create a simple project 체크</li>
    </ul>
  </li>
</ol>

<h2 id="pom">POM</h2>
<p>이번에는 각 프로젝트의 pom.xml을 작성해 봅시다. 일단 가장 미니멀하게 구성합니다.</p>

<h3 id="최상위-cms---pomxml">최상위 CMS - POM.XML</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>2.2.3.RELEASE<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;relativePath</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>cms<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;packaging&gt;</span>pom<span class="nt">&lt;/packaging&gt;</span>
	<span class="nt">&lt;modules&gt;</span>
		<span class="nt">&lt;module&gt;</span>core<span class="nt">&lt;/module&gt;</span>
		<span class="nt">&lt;module&gt;</span>web<span class="nt">&lt;/module&gt;</span>
	<span class="nt">&lt;/modules&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<ul>
  <li>packaging이 pom</li>
  <li>상위(parent)에 spring-boot-starter-parent와 이에 대한 버전이 명시</li>
  <li>하위 모듈로 core와 web이 존재</li>
</ul>

<h3 id="core---pomxml">CORE - POM.XML</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>cms<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>core<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>

	<span class="nt">&lt;dependencies&gt;</span>
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>		
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>com.h2database<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>h2<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<ul>
  <li>일단 DBMS를 h2로 사용</li>
  <li>DB를 조작하기 위해 ORM기반의 JPA사용</li>
</ul>

<h3 id="web---pomxml">WEB - POM.XML</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>cms<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>web<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;dependencies&gt;</span>
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>core<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>	
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>		
	<span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>
<ul>
  <li>공통 로직이 포함된 core에 대한 dependency를 추가</li>
  <li>spring-boot-starter-web을 추가</li>
</ul>

<h2 id="java">JAVA</h2>
<p>위에서 각 메이븐 모듈들을 구성하고 각 모듈들의 pom을 작성하였습니다. 마지막으로 자바 코드를 작성해 core와 web의 연동을 확인해 보겠습니다.</p>

<h3 id="core---boardservicejava">CORE - BoardService.java</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">io</span><span class="o">.</span><span class="na">youngwon</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoardService</span> <span class="o">{</span>
	
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">"hi"</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="web">WEB</h3>
<h4 id="applicationjava">Application.java</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">io</span><span class="o">.</span><span class="na">youngwon</span><span class="o">.</span><span class="na">web</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span><span class="o">(</span><span class="n">scanBasePackages</span> <span class="o">=</span> <span class="s">"io.youngwon.web"</span><span class="o">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>
	
 
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">Application</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>	

</code></pre></div></div>
<h4 id="maincontrollerjava">MainController.java</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">io</span><span class="o">.</span><span class="na">youngwon</span><span class="o">.</span><span class="na">web</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">io.youngwon.core.BoardService</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainController</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">final</span> <span class="n">BoardService</span> <span class="n">boardService</span><span class="o">;</span>
	 
	
	<span class="kd">public</span> <span class="nf">MainController</span><span class="o">(</span><span class="n">BoardService</span> <span class="n">boardService</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">boardService</span> <span class="o">=</span> <span class="n">boardService</span><span class="o">;</span>
	<span class="o">}</span>
	
 
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">isEvenOrOdd</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">boardService</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>MainController에 선언된 get에 접근시 “hi1”가 출력되는 것을 확인 할 수 있다.</p>

<h1 id="references">References</h1>
<ul>
  <li>https://spring.io/guides/gs/multi-module/</li>
  <li>https://www.baeldung.com/spring-boot-multiple-modules</li>
</ul>


  
  <div class="post-disqus">
      <section id="disqus_thread"></section>
      <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://youngwonseo.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
  </div>
  
</div>

<div class="pagination">
  
    <a href="/2020/02/29/02-spring-cms/" class="left arrow">&#8592;</a>
  
  
    <a href="/2020/02/28/spring-cheat-sheet/" class="right arrow">&#8594;</a>
  

  <a href="#" class="top">Top</a>
</div>

    </main>

    <footer>
      <span>
        &copy; <time datetime="2020-03-04 00:15:58 +0900">2020</time> Youngwon Seo. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
      </span>
    </footer>
  </body>
</html>
