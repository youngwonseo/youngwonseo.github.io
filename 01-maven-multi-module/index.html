<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">
  
  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>메이븐 멀티모듈 SNS 개발 #1 - 프로젝트 구성 | 서영원 블로그</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="메이븐 멀티모듈 SNS 개발 #1 - 프로젝트 구성" />
<meta name="author" content="Youngwon Seo" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="본 포스트는 메이븐 멀티 모듈을 기반으로 스프링 프로젝트들을 구성하고 SNS 서비스를 개발을 합니다." />
<meta property="og:description" content="본 포스트는 메이븐 멀티 모듈을 기반으로 스프링 프로젝트들을 구성하고 SNS 서비스를 개발을 합니다." />
<link rel="canonical" href="https://youngwonseo.github.io/01-maven-multi-module/" />
<meta property="og:url" content="https://youngwonseo.github.io/01-maven-multi-module/" />
<meta property="og:site_name" content="서영원 블로그" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-29T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="메이븐 멀티모듈 SNS 개발 #1 - 프로젝트 구성" />
<script type="application/ld+json">
{"datePublished":"2020-02-29T00:00:00+09:00","url":"https://youngwonseo.github.io/01-maven-multi-module/","mainEntityOfPage":{"@type":"WebPage","@id":"https://youngwonseo.github.io/01-maven-multi-module/"},"dateModified":"2020-02-29T00:00:00+09:00","author":{"@type":"Person","name":"Youngwon Seo"},"description":"본 포스트는 메이븐 멀티 모듈을 기반으로 스프링 프로젝트들을 구성하고 SNS 서비스를 개발을 합니다.","@type":"BlogPosting","headline":"메이븐 멀티모듈 SNS 개발 #1 - 프로젝트 구성","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  
  
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://youngwonseo.github.io/01-maven-multi-module/">
  <link rel="alternate" type="application/atom+xml" title="서영원 블로그" href="https://youngwonseo.github.io/feed.xml" />  
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/moonspam/NanumBarunGothic@latest/nanumbarungothicsubset.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
</head>

  <body>
    

<div class="header-container" id="header-container">

<!-- Site navigation -->
  <nav class="site-nav">
    <div class="trigger">
      
        
        <a class="page-link" href="/about/">About</a>
        
      
        
        <a class="page-link" href="/archive/">Archive</a>
        
      
        
      
        
      
        
      
        
        <a class="page-link" href="/category/">Paper</a>
        
      
        
        <a class="page-link" href="/projects/">Projects</a>
        
      
        
        <a class="page-link" href="/study/">Study</a>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      <a class="page-link" href="/feed.xml">RSS</a>
    </div>
  </nav>

  <!-- The title of the site -->
  <header class="site-header">
    <!-- <a href="/">
      <div class="avatar">
        <img src="/assets/images/avatar.png" />
      </div>
    </a> -->
    <a class="site-title" href="/">서영원 블로그</a>
  </header>

</div>

      <div class="wrapper">
        <div class="page-content">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">메이븐 멀티모듈 SNS 개발 #1 - 프로젝트 구성</h1>
    <p class="post-meta">2020-02-29 / Youngwon Seo</p>
  </header>



  <article class="post-content">
    <p>본 포스트는 메이븐 멀티 모듈을 기반으로 스프링 프로젝트들을 구성하고 SNS 서비스를 개발을 합니다.</p>

<h2 id="메이븐-멀티-모듈">메이븐 멀티 모듈</h2>
<p>프로젝트를 진행하다 보면 단일 프로젝트가 아닌 여러개의 프로젝트로 구성해야할 경우가 많습니다. 특히 마이크로서비스(Microservice)등의 기술로 인해 기존의 front-end와 back-end뿐만 아니라 기능별로 프로젝트를 분리하고 각 모듈별로 배포 및 운영가능하게 만드는 것이 당연시 되고 있습니다.</p>

<p>스프링 기반으로 정산시스템을 만든다고 생각해 봅시다. 우리는 사용자에게 자신의 요금을 조회할 수 있는 웹 어플리케이션이 필요합니다. 또한 매달 또는 매주 한번씩 실행되는 배치 어플리케이션이 필요하죠. 이는 다음과 같이 표현할 수 있습니다.
<img src="/public/spring/01-multiple-spring.png" alt="" /></p>

<p>위와 같이 여러개의 프로젝트를 구성할 때 각 프로젝트에는 DB에 접근하는 Repository나 비즈니스 로직이 포함된 Service가 포함되는데 이는 중복코드를 발생시킬 위험이 존재합니다(위험이 이라고 포함되었지만 무조건 발생할 수 밖에 없습니다). 즉 동일한 도메인(Entity)이 사용되면 개발시 또는 수정시 copy&amp;paste 신동이 되어야할 수 밖에 없습니다. 이를 해결하기 위해 프로젝트를 분리해야 하는데 다음과 같은 방법을 사용할 수 있습니다.</p>
<ul>
  <li>공통 로직을 jar로 maven repo나 gradle repo로 배포</li>
  <li>공통 로직 담은 프로젝트를 IDE의 project explorer환경에서 import</li>
  <li>메이븐 멀티 모듈로 프로젝트를 구성</li>
</ul>

<p>첫 번째는 방법은 공통을 담고 있는 프로젝트를 구성하고 공통로직을 사용하는 프로젝트에서 maven이나 gradle로 import하는것입니다. 하지만 수정시 매번 재배포하고 import하는 프로젝트들을 테스트해야하는 불편함이 존재합니다. 두 번째 방법은 첫 번째 방법과 세 번째 방법의 사이에 존재하는데 IDE환경에서 프로젝트를 jar로 import해서 사용하는 방법입니다. 세 번째 방법은 같이 사용할 프로젝트를 메이픈 멀티 모듈로 구성해 각 프로젝트들이 동일한 로직이나 도메인을 사용할 때 같은 코드를 사용할 수 있도록 보장받는 것입니다.</p>

<p>위 프로젝트를 메이븐 멀티 모듈로 구성하면 다음과 같이 표현할 수 있습니다(API를 추가하였습니다).</p>

<p><img src="/public/spring/02-maven-multi-module.png" alt="" /></p>

<p>본 포스트에서는 메이븐 멀티 모듈 기반의 SNS를 개발해 보겠습니다. 도메인으로 구성된 <strong>module-domain</strong>과 비즈니스 정보가 포함된 <strong>module-core</strong>, 사용자가 접근하는 <strong>module-web</strong>, API를 제공하는 <strong>module-api</strong>로 구성됩니다.</p>

<p>자바를 기반으로 프로젝트를 진행하다보면 많은 외부 라이브러리(또는 의존성 : dependency, 보통의 경우 자바기반의 라이브러리 : jar)를 추가적으로 사용하게 됩니다. 이를 효율적으로 관리하는 도구가 메이븐(maven)입니다. 메이븐은 설정(pom.xml)을 저장소에 등록된 라이브러리를 현재 프로젝트에서 사용가능하게 하며 배포나 라이브러리 변경시</p>

<h4 id="개발환경">개발환경</h4>
<p>초기에 세팅해야하는 항목만 명시합니다.</p>
<ul>
  <li>Spring Boot</li>
  <li>JPA</li>
  <li>STS4(ecplise)</li>
  <li>lombok</li>
</ul>

<h2 id="프로젝트-구성">프로젝트 구성</h2>
<p>최상위 프로젝트는 maven project이고 그 외 내부 프로젝트는 maven module입니다. 모두 simple project로 설정합니다.</p>

<ol>
  <li>maven-multi-module-sns (상위 프로젝트)
    <ul>
      <li>maven project로 생성</li>
      <li>create a simple project 체크</li>
      <li>패키징을 POM으로 선택</li>
    </ul>
  </li>
  <li>module-domain (하위 프로젝트1)
    <ul>
      <li>상위 프로젝트에 대한 maven moule로 생성
      * create a simple project 체크</li>
    </ul>
  </li>
  <li>module-core (하위 프로젝트2)
    <ul>
      <li>상위 프로젝트에 대한 maven moule로 생성</li>
      <li>create a simple project 체크</li>
    </ul>
  </li>
  <li>module-api (하위 프로젝트3)
    <ul>
      <li>상위 프로젝트에 대한 maven moule로 생성
      * create a simple project 체크</li>
    </ul>
  </li>
  <li>module-web (하위 프로젝트3)
    <ul>
      <li>상위 프로젝트에 대한 maven moule로 생성</li>
      <li>create a simple project 체크</li>
    </ul>
  </li>
</ol>

<h2 id="pom">POM</h2>
<p>이번에는 각 프로젝트의 pom.xml을 작성해 봅시다. 일단 가장 미니멀하게 구성합니다.</p>

<h3 id="최상위-cms---pomxml">최상위 CMS - POM.XML</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>2.2.3.RELEASE<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;relativePath</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>cms<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;packaging&gt;</span>pom<span class="nt">&lt;/packaging&gt;</span>
	<span class="nt">&lt;modules&gt;</span>
		<span class="nt">&lt;module&gt;</span>core<span class="nt">&lt;/module&gt;</span>
		<span class="nt">&lt;module&gt;</span>web<span class="nt">&lt;/module&gt;</span>
	<span class="nt">&lt;/modules&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<ul>
  <li>packaging이 pom</li>
  <li>상위(parent)에 spring-boot-starter-parent와 이에 대한 버전이 명시</li>
  <li>하위 모듈로 core와 web이 존재</li>
</ul>

<h3 id="core---pomxml">CORE - POM.XML</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>cms<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>core<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>

	<span class="nt">&lt;dependencies&gt;</span>
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>		
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>com.h2database<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>h2<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<ul>
  <li>일단 DBMS를 h2로 사용</li>
  <li>DB를 조작하기 위해 ORM기반의 JPA사용</li>
</ul>

<h3 id="web---pomxml">WEB - POM.XML</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
	<span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>cms<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span> 
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>web<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;dependencies&gt;</span>
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>io.youngwon<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>core<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>	
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>		
	<span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>
<ul>
  <li>공통 로직이 포함된 core에 대한 dependency를 추가</li>
  <li>spring-boot-starter-web을 추가</li>
</ul>

<h2 id="java">JAVA</h2>
<p>위에서 각 메이븐 모듈들을 구성하고 각 모듈들의 pom을 작성하였습니다. 마지막으로 자바 코드를 작성해 core와 web의 연동을 확인해 보겠습니다.</p>

<h3 id="core---boardservicejava">CORE - BoardService.java</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">io.youngwon</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoardService</span> <span class="o">{</span>
	
	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">"hi"</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="web">WEB</h3>
<h4 id="applicationjava">Application.java</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">io.youngwon.web</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span><span class="o">(</span><span class="n">scanBasePackages</span> <span class="o">=</span> <span class="s">"io.youngwon.web"</span><span class="o">)</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>
	
 
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">Application</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>	

</code></pre></div></div>
<h4 id="maincontrollerjava">MainController.java</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">io.youngwon.web</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">io.youngwon.core.BoardService</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainController</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">final</span> <span class="nc">BoardService</span> <span class="n">boardService</span><span class="o">;</span>
	 
	
	<span class="kd">public</span> <span class="nf">MainController</span><span class="o">(</span><span class="nc">BoardService</span> <span class="n">boardService</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">boardService</span> <span class="o">=</span> <span class="n">boardService</span><span class="o">;</span>
	<span class="o">}</span>
	
 
  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">isEvenOrOdd</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">boardService</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>MainController에 선언된 get(“/”)에 접근시 “hi”가 출력되는 것을 확인 할 수 있다.</p>

<h1 id="references">References</h1>
<ul>
  <li>https://spring.io/guides/gs/multi-module/</li>
  <li>https://www.baeldung.com/spring-boot-multiple-modules</li>
  <li>https://woowabros.github.io/study/2019/07/01/multi-module.html</li>
  <li>https://jojoldu.tistory.com/123</li>
</ul>

  </article>

  <hr>

  <!-- <div class="question">
    <h2>Questions?</h2>
    <p>Have a question regarding the post above? <br />Or any of my designs?</p>
    

  </div> -->

  <!-- <div class="related">
    <h2>Related</h2>
    
      <li><a href="/replica-set/" title="Replica Set">Replica Set
       &nbsp; <span class="post-meta">February 16, 2021</span></a>
    
      <li><a href="/docker-java-deployment/" title="Docker Java Deployment">Docker Java Deployment
       &nbsp; <span class="post-meta">February 16, 2021</span></a>
    
      <li><a href="/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4/pod/" title="쿠버네티스 - 포드(Pod)">쿠버네티스 - 포드(Pod)
       &nbsp; <span class="post-meta">February 15, 2021</span></a>
    
  </div> -->

  
  

</div>

        </div>
        <footer class="site-footer">
<p class="small"></p>
</footer>

    </div>

    <script src="//cdn.jsdelivr.net/headroomjs/0.5.0/headroom.min.js"></script>
    <script type="text/javascript">
      var el = document.querySelector(".header-container");
      var headroom  = new Headroom(el, {
        "offset": 205,
        "tolerance": 5
      });
      headroom.init();
    </script>


    <!-- Twitter Shizzle -->
    <script type="text/javascript">
    window.twttr = (function (d, s, id) {
      var t, js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src= "https://platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js, fjs);
      return window.twttr || (t = { _e: [], ready: function (f) { t._e.push(f) } });
    }(document, "script", "twitter-wjs"));
    </script>

  </body>
</html>
